<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rex_game</title>
    <style>
    .window {
        position: relative;
        width: 100%;
        height: 300px;
        background-color: black;
        border: 2px solid red;
        display: flex;
        justify-content: center;
        align-items: center;
        overflow: hidden;
    }
    body {
        background-color: black;
    }
    .obstaculo {
        position: absolute;
        bottom: 0;
        width: 50px;
        right: -50px;
        animation: obstaculoAnimation 4s linear;
    }
    h1 {
        color: white;
    }
    .player {
        position: absolute;
        bottom: 0;
        color: red;
        width: 40px;
        left: 60px;
        transition: bottom 0.3s ease, font-size 0.3s ease;
    }
    .jump {
        animation: jump 800ms ease-out;
    }
    .jump-elevated {
        animation: jumpElevated 800ms ease-out;
    }
    @keyframes obstaculoAnimation {
        from {
            right: -50px;
        }
        to {
            right: 107%;
        }
    }
    @keyframes jump {
        0% {
            bottom: 0;
        }
        50% {
            bottom: 150px;
        }
        70% {
          bottom: 150px;
    }
        80% {
          bottom: 100px;
    }
        100% {
            bottom: 0;
        }
    }
    @keyframes jumpElevated {
        0% {
            bottom: 120px;
        }
        50% {
            bottom: 270px;
        }
        70% {
            bottom: 270px;
    }
        80% {
            bottom: 220;
    }
        100% {
            bottom: 120px;
        }
    }
    .gameOver {
        position: absolute;
        display: none;
        animation: gameOverAnimation 1500ms ease-out;
    }
    @keyframes gameOverAnimation {
        0%{
          top: 0;
        }
        40% {
          top: 20px;
        }
        70% {
          top: 60px;
        }
        88% {
          top: 80px;
        }
        100% {
          top: 90px;
        }
    }
    .textGameOver {
        font-size: 50px;
    }
    .portal {
        color: blue;
        width: 50px;
        position: absolute;
        right: -50px;
        
        animation: portalAnimation 1800ms linear;
    }
    @keyframes portalAnimation {
        0% {
            right: 0;
            bottom: 0;
        }
        50% {
            right: 40%;
            bottom: 23%;
        }
        10% {
            bottom: 70px;
    }
        100% {
            right: 107%;
            bottom: 0;
        }
    }
    </style>
</head>
<body>
    <div class="window">
        <h1 class="player">Run</h1>
        <h1 class="obstaculo">trashCan</h1>
        <h1 class="portal">Portal</h1>
        <div class="gameOver">
            <h1 class="textGameOver">Game over</h1>
        </div>
    </div>

    <script>
        const player = document.querySelector('.player');
        const obstaculo = document.querySelector('.obstaculo');
        const gameOver = document.querySelector('.gameOver');
        const portal = document.querySelector('.portal');

        let isElevated = false;
        let loop;

        const jump = () => {
            if (!player.classList.contains('jump') && !player.classList.contains('jump-elevated')) {
                player.classList.add(isElevated ? 'jump-elevated' : 'jump');
                setTimeout(() => {
                    player.classList.remove('jump');
                    player.classList.remove('jump-elevated');
                }, 800);
            }
        };

        const tempoObstaculo = [1030, 6012, 9689, 150, 214, 4231];
        const mostrarObstaculo = () => {
            obstaculo.style.display = "block";
            obstaculo.style.animation = "none";
            obstaculo.offsetHeight; // Trigger reflow
            obstaculo.style.animation = "obstaculoAnimation 4s linear";
            setTimeout(() => {
                obstaculo.style.display = "none";
                const proximoTempo = tempoObstaculo[Math.floor(Math.random() * tempoObstaculo.length)];
                setTimeout(mostrarObstaculo, proximoTempo);
            }, 4000); // Match animation duration
        };
        mostrarObstaculo();

        const temposPortal = [3770, 5807, 8305, 930, 592];
        const mostrarPortal = () => {
            portal.style.display = "block";
            portal.style.animation = "none";
            portal.offsetHeight; // Trigger reflow
            portal.style.animation = "portalAnimation 1800ms linear";
            setTimeout(() => {
                portal.style.display = "none";
                const proximoTempo = temposPortal[Math.floor(Math.random() * temposPortal.length)];
                setTimeout(mostrarPortal, proximoTempo);
            }, 1800); // Match animation duration
        };
        mostrarPortal();

        const playerTempoHigh = [5000, 1000, 3000, 200, 100, 400];

        loop = setInterval(() => {
            const obstaculoPosition = obstaculo.offsetLeft;
            const obstaculoBottom = parseInt(window.getComputedStyle(obstaculo).bottom);
            const playerPosition = parseInt(window.getComputedStyle(player).bottom);
            const portalPosition = portal.offsetLeft;

            // Collision with obstacle (dies regardless of elevation)
            if (obstaculoPosition <= 90 && obstaculoPosition > 0 && Math.abs(playerPosition - obstaculoBottom) < 55) {
                obstaculo.style.animation = "none";
                obstaculo.style.left = obstaculoPosition + "px";
                player.style.display = "none";
                gameOver.style.display = "flex";
                portal.style.display = "none";
                clearInterval(loop);
            }

            // Collision with portal
            if (portalPosition <= 90 && portalPosition > 0 && playerPosition < 55 && !isElevated) {
                isElevated = true;
                player.style.bottom = "120px";
                player.style.fontSize = "20px";
                obstaculo.style.bottom = "120px";
                portal.style.display = "none";
                const tempoDescida = playerTempoHigh[Math.floor(Math.random() * playerTempoHigh.length)];
                setTimeout(() => {
                    if (isElevated) {
                        player.style.bottom = "0";
                        player.style.fontSize = "32px";
                        obstaculo.style.bottom = "0";
                        isElevated = false;
                    }
                }, tempoDescida);
            }
        }, 10);

        document.addEventListener("keydown", jump);
    </script>
</body>
</html>

